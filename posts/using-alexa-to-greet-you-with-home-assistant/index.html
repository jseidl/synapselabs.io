<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="utf-8">
  <title>Using Alexa to greet you with Home Assistant</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description"
    content="Make Alexa (or Google Home) greet you when you arrive home using a door sensor, GPS trackers and Home Assistant!">
  
  <meta name="author" content="Jan Seidl">
  <meta name="generator" content="Hugo 0.65.3" />

  <!-- plugins -->
  
  <link rel="stylesheet" href="https://synapselabs.io/plugins/bootstrap/bootstrap.min.css ">
  
  <link rel="stylesheet" href="https://synapselabs.io/plugins/themify-icons/themify-icons.css ">
  

  <!-- Main Stylesheet -->
  
  <link rel="stylesheet" href="https://synapselabs.io/scss/style.min.css" media="screen">

  <!--Favicon-->
  <link rel="shortcut icon" href="https://synapselabs.io/images/favicon.png " type="image/x-icon">
  <link rel="icon" href="https://synapselabs.io/images/favicon.png " type="image/x-icon">

  
  
  

</head><body>
    
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    
<!-- preloader start -->
<div class="preloader">
  
</div>
<!-- preloader end -->
<!-- navigation -->
<header class="fixed-top navigation">
  <div class="container">
    
    <nav class="navbar navbar-expand-lg navbar-light bg-transparent">
      <a class="navbar-brand"href="https://synapselabs.io/"><img class="img-fluid" src="/images/logo.png" alt="synapse labs ðŸ§ "></a>
      <button class="navbar-toggler border-0" type="button" data-toggle="collapse" data-target="#navigation">
        <i class="ti-menu h3"></i>
      </button>

      <div class="collapse navbar-collapse text-center" id="navigation">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link" href="https://synapselabs.io/"> Home </a>
          </li>
          
            
            <li class="nav-item">
              <a class="nav-link" href="https://synapselabs.io/about">About</a>
            </li>
            
          
            
            <li class="nav-item">
              <a class="nav-link" href="https://synapselabs.io/contact">Contact</a>
            </li>
            
          
        </ul>
        
        <!-- search -->
        <div class="search">
          <button id="searchOpen" class="search-btn"><i class="ti-search"></i></button>
          <div class="search-wrapper">
            <form action="https://synapselabs.io//search" class="h-100">
              <input class="search-box px-4" id="search-query" name="s" type="search" placeholder="Type & Hit Enter...">
            </form>
            <button id="searchClose" class="search-close"><i class="ti-close text-dark"></i></button>
          </div>
        </div>
        
      </div>
    </nav>
  </div>
</header>
<!-- /navigation --> <div class="py-5 d-none d-lg-block"></div> 

<section class="section">
  <div class="container">
    <div class="row">
      <div class="col-lg-12 mx-auto block shadow mb-5">
        <h2>Using Alexa to greet you with Home Assistant</h2>
        <div class="mb-3 post-meta">
          <a href="/author/jan-seidl">Jan Seidl</a>,
          March 30, 2020, in 
          <a href="/categories/home-automation">Home automation</a>
          
        </div>
        
        <img src="/images/featured-post/using-alexa-to-greet-you-with-home-assistant.jpg" class="img-fluid w-100 mb-4" alt="Using Alexa to greet you with Home Assistant">
        
        <div class="content">
          <p>If there&rsquo;s one thing that makes everyone feels better despite having no friends, is having robots talking to you like they cared. From today on, every time you arrive home to your empty house <del>because your partner divorced you and took your kids and your dog</del>, you will feel that warmth in your heart.</p>
<p>For that, we&rsquo;re gonna need the <a href="https://github.com/helto4real/hassio-add-ons/tree/master/presence">Better Presence Add-On</a> for Home Assistant &ndash; in order to know when we <em>just arrived</em>, a Door Sensor (I use Z-Wave <a href="https://amzn.to/2PzI0Nq">Aeotec Door/Window Sensor 7</a>) to know when we exactly open the front door and the <a href="https://github.com/custom-components/alexa_media_player">Alexa Media Player</a> custom component.</p>
<p>We will start by using the <code>device_tracker</code> sensor (created by <em>Better Presence</em>) as a trigger:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">trigger:
    - <span style="color:#66d9ef">platform</span>: state
      <span style="color:#66d9ef">entity_id</span>: device_tracker.jseidl_presence
      <span style="color:#66d9ef">to</span>: <span style="color:#e6db74">&#39;Just arrived&#39;</span>
</code></pre></div><p>The <a href="https://www.home-assistant.io/docs/scripts/#wait"><code>wait_template</code></a> action type in Home Assistant&rsquo;s the script syntax (used in automations) enables us to wait until a sensor gets into a given state before giving up (<code>timeout</code> configurable) and we will use that to make our automation wait until the front door is open.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- <span style="color:#66d9ef">wait_template</span>: <span style="color:#e6db74">&#34;{{ is_state(&#39;binary_sensor.door_main&#39;, &#39;on&#39;) }}&#34;</span>
  <span style="color:#66d9ef">timeout</span>: <span style="color:#e6db74">&#39;00:05:00&#39;</span>
</code></pre></div><p>Finally, we use <em>Alexa Media Player</em>&lsquo;s <code>notify</code> service endpoint to greet us:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- <span style="color:#66d9ef">service</span>: notify.alexa_media_echo_dot_living_room
  data:
    data:
    <span style="color:#66d9ef">type</span>: announce
    <span style="color:#66d9ef">message</span>: <span style="color:#e6db74">&#39;Welcome home Jan!&#39;</span>
</code></pre></div><p><em>(Option #2) Use Google Assistant and Google Translate&rsquo;s <code>tts</code> platform:</em></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">- <span style="color:#66d9ef">service</span>: tts.google_translate_say
  <span style="color:#66d9ef">entity_id</span>: media_player.living_room_google_home
  data:
    <span style="color:#66d9ef">message</span>: <span style="color:#e6db74">&#39;Welcome home Jan!&#39;</span>
</code></pre></div><p>The full code:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml">automation:
  - <span style="color:#66d9ef">alias</span>: <span style="color:#e6db74">&#39;Greets when Jan arrives (Alexa)&#39;</span>
    trigger:
      - <span style="color:#66d9ef">platform</span>: state
        <span style="color:#66d9ef">entity_id</span>: device_tracker.jseidl_presence
        <span style="color:#66d9ef">to</span>: <span style="color:#e6db74">&#39;Just arrived&#39;</span>
    condition:
        - <span style="color:#66d9ef">condition</span>: state
          <span style="color:#66d9ef">entity_id</span>: input_boolean.voice_notifications
          <span style="color:#66d9ef">state</span>: <span style="color:#e6db74">&#39;on&#39;</span>
    action:
      - <span style="color:#66d9ef">wait_template</span>: <span style="color:#e6db74">&#34;{{ is_state(&#39;binary_sensor.door_main&#39;, &#39;on&#39;) }}&#34;</span>
        <span style="color:#66d9ef">timeout</span>: <span style="color:#e6db74">&#39;00:05:00&#39;</span>
      - <span style="color:#66d9ef">service</span>: notify.alexa_media_echo_dot_living_room
        data:
          data:
            <span style="color:#66d9ef">type</span>: announce
          <span style="color:#66d9ef">message</span>: <span style="color:#e6db74">&#39;Welcome home Jan!&#39;</span>
</code></pre></div><p>That&rsquo;s it! Hope that helps bringing a little more joy to your day!</p>
        </div>
      </div>
      <div class="col-lg-12 mx-auto block shadow mb-5">
        
        
        
      </div>
      
      <div class="col-lg-12 mx-auto block shadow">
        
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "synapse-labs" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
      </div>
      
    </div>
  </div>
</section>


<footer class="py-4 bg-light border-top">
  <div class="container">
    <div class="row justify-content-between align-items-center">
      <div class="col-lg-4 text-center text-lg-left mb-4 mb-lg-0">
        <a href="https://synapselabs.io/" class="d-block pb-3"><img src="/images/logo.png" class="img-fluid" alt="synapse labs ðŸ§ "></a>
      </div>
      <div class="col-lg-4 text-center mb-4 mb-lg-0">
        <ul class="list-inline mb-0">
          
          <li class="list-inline-item"><a class="text-dark d-block p-2" href="https://synapselabs.io/about">About</a></li>
          
          <li class="list-inline-item"><a class="text-dark d-block p-2" href="https://synapselabs.io/contact">Contact</a></li>
          
        </ul>
      </div>
      <div class="col-lg-4 text-lg-right text-center mb-4 mb-lg-0">
        <ul class="list-inline social-icon mb-0">
          
          <li class="list-inline-item"><a href="https://twitter.com/jseidl"><i class="ti-twitter-alt"></i></a></li>
          
          <li class="list-inline-item"><a href="https://github.com/jseidl"><i class="ti-github"></i></a></li>
          
          <li class="list-inline-item"><a href="https://www.linkedin.com/in/janseidl"><i class="ti-linkedin"></i></a></li>
          
        </ul>
      </div>
    </div>
    <div class="text-center mt-4">
      <span>Â© 2020 <a href="https://synapselabs.io">synapse labs</a> All Rights Reserved</span>
    </div>
  </div>
</footer>




<script>
  var indexURL = "https://synapselabs.io/index.json"
</script>


<!-- JS Plugins -->

<script src="https://synapselabs.io/plugins/jQuery/jquery.min.js"></script>

<script src="https://synapselabs.io/plugins/bootstrap/bootstrap.min.js"></script>

<script src="https://synapselabs.io/plugins/search/fuse.min.js"></script>

<script src="https://synapselabs.io/plugins/search/mark.js"></script>

<script src="https://synapselabs.io/plugins/search/search.js"></script>


<!-- Main Script -->

<script src="https://synapselabs.io/js/script.min.js"></script>

<!-- google analitycs -->
</body>

</html>